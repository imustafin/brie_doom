<!DOCTYPE html>
<html>
<head>
<meta name="generator" content="ISE EiffelStudio version 19.05.10.3187 GPL Edition - unix">
<meta name="description" content="p_spec.c Implements special effects: Texture animation, height or lighting changes  according to adjacent sectors, respective  utility functions, etc. Line Tag handling. Line and Sector triggers."/>
<meta name="keywords" content="Eiffel class"/>
<meta name="keywords" content="Eiffel class"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet">
<title>p_spec Text</title>
<link rel="stylesheet" href="../default.css" type="text/css">
<script type="text/javascript" src="../goto.html"></script>
</head>
<body>
<pre></pre><form class="nav" onsubmit="go_to('../',this.c.value);return false;">
<div class="nav">
<a class="nav hierarchy" href="../class_list.html">Classes</a>
<a class="nav hierarchy" href="../cluster_list.html">Clusters</a>
<a class="nav hierarchy" href="../cluster_hierarchy.html">Cluster hierarchy</a>
<a class="nav class" href="p_spec_chart.html">Chart</a>
<a class="nav class" href="p_spec_links.html">Relations</a>
<span class="nav class selected">Text</span>
<span class="nav class goto">Go to: <input name="c" value="p_spec"></span>
</div></form><pre><span class="ekeyword">note</span>
	<span class="eitag">description</span><span class="esymbol">:</span> <span class="estring">&quot;</span><span class="estring">[</span>
		<span class="estring">p_spec.c</span>
		<span class="estring">Implements special effects:</span>
		<span class="estring">Texture animation, height or lighting changes</span>
		<span class="estring"> according to adjacent sectors, respective</span>
		<span class="estring"> utility functions, etc.</span>
		<span class="estring">Line Tag handling. Line and Sector triggers.</span>
	<span class="estring">]</span><span class="estring">&quot;</span>

<span class="ekeyword">class</span> 
	<a class="eclass" href="../brie_doom/p_spec.html">P_SPEC</a>

<span class="ekeyword">create</span> 
	<a class="efeature" href="../brie_doom/p_spec.html#f_make">make</a>

<span class="ekeyword">feature</span> 

	<a name="f_make"></a><a class="efeature" href="../brie_doom/p_spec.html#f_make">make</a>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_vdoorspeed"></a><a class="efeature" href="../brie_doom/p_spec.html#f_vdoorspeed">Vdoorspeed</a><span class="esymbol">:</span> <a class="eclass" href="../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">once</span>
			<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a> <a class="esymbol" href="../base/integer_32.html#f_product">*</a> <span class="enumber">2</span>
		<span class="ekeyword">ensure</span>
			<span class="etag">instance_free</span><span class="esymbol">:</span> <span class="ekeyword">class</span>
		<span class="ekeyword">end</span>

	<a name="f_vdoorwait"></a><a class="efeature" href="../brie_doom/p_spec.html#f_vdoorwait">Vdoorwait</a><span class="esymbol">:</span> <a class="eclass" href="../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">150</span>

	<a name="f_maxswitches"></a><a class="efeature" href="../brie_doom/p_spec.html#f_maxswitches">Maxswitches</a><span class="esymbol">:</span> <a class="eclass" href="../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">50</span>
			<span class="ecomment">--</span><span class="ecomment"> max # of wall switches in a level</span>

	<a name="f_maxbuttons"></a><a class="efeature" href="../brie_doom/p_spec.html#f_maxbuttons">Maxbuttons</a><span class="esymbol">:</span> <a class="eclass" href="../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">16</span>
			<span class="ecomment">--</span><span class="ecomment"> 4 players, 4 buttons each at once, max.</span>

	<a name="f_buttontime"></a><a class="efeature" href="../brie_doom/p_spec.html#f_buttontime">Buttontime</a><span class="esymbol">:</span> <a class="eclass" href="../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">35</span>
			<span class="ecomment">--</span><span class="ecomment"> 1 second, in ticks.</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_p_initpicanims"></a><a class="efeature" href="../brie_doom/p_spec.html#f_p_initpicanims">p_initpicanims</a>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<a name="f_p_spawnspecials"></a><a class="efeature" href="../brie_doom/p_spec.html#f_p_spawnspecials">p_spawnspecials</a>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<a name="f_p_updatespecials"></a><a class="efeature" href="../brie_doom/p_spec.html#f_p_updatespecials">p_updatespecials</a>
			<span class="ecomment">--</span><span class="ecomment"> Animate planes, scroll walls, etc.</span>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<a name="f_p_playerinspecialsector"></a><a class="efeature" href="../brie_doom/p_spec.html#f_p_playerinspecialsector">p_playerinspecialsector</a> <span class="esymbol">(</span><span class="elocal">player</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/player_t.html">PLAYER_T</a><span class="esymbol">)</span>
			<span class="ecomment">--</span><span class="ecomment"> Called every tic frame</span>
			<span class="ecomment">--</span><span class="ecomment"> that the player origin is in a special sector</span>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<a name="f_p_crossspecialline"></a><a class="efeature" href="../brie_doom/p_spec.html#f_p_crossspecialline">p_crossspecialline</a> <span class="esymbol">(</span><span class="elocal">linenum</span><span class="esymbol">,</span> <span class="elocal">side</span><span class="esymbol">:</span> <a class="eclass" href="../base/integer_32.html">INTEGER_32</a><span class="esymbol">;</span> <span class="elocal">thing</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/mobj_t.html">MOBJ_T</a><span class="esymbol">)</span>
			<span class="ecomment">--</span><span class="ecomment"> Called every time a thing origin is about</span>
			<span class="ecomment">--</span><span class="ecomment"> to cross a line with a non 0 special</span>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<a name="f_p_findlowestceilingsurrounding"></a><a class="efeature" href="../brie_doom/p_spec.html#f_p_findlowestceilingsurrounding">p_findlowestceilingsurrounding</a> <span class="esymbol">(</span><span class="elocal">sec</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/render/sector_t.html">SECTOR_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/math/fixed_t.html">FIXED_T</a>
		<span class="ekeyword">local</span>
			<span class="elocal">i</span><span class="esymbol">:</span> <a class="eclass" href="../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">ch</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/render/line_t.html">LINE_T</a>
			<span class="elocal">other</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/render/sector_t.html">SECTOR_T</a>
		<span class="ekeyword">do</span>
			<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../brie_doom/doomtype_h.html">DOOMTYPE_H</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../brie_doom/doomtype_h.html#f_maxint">maxint</a><span class="esymbol">)</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">sec</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/sector_t.html#f_lines">lines</a><span class="edot">.</span><a class="efeature" href="../base/chain.html#f_lower">Lower</a>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../base/comparable.html#f_is_greater">&gt;</a> <span class="elocal">sec</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/sector_t.html#f_lines">lines</a><span class="edot">.</span><a class="efeature" href="../base/arrayed_list.html#f_upper">upper</a>
			<span class="ekeyword">loop</span>
				<span class="elocal">ch</span> <span class="esymbol">:=</span> <span class="elocal">sec</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/sector_t.html#f_lines">lines</a> <a class="esymbol" href="../base/arrayed_list.html#f_i_th">[</a><span class="elocal">i</span><a class="esymbol" href="../base/arrayed_list.html#f_i_th">]</a>
				<span class="elocal">other</span> <span class="esymbol">:=</span> <a class="efeature" href="../brie_doom/p_spec.html#f_getnextsector">getnextsector</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">ch</span><span class="esymbol">,</span> <span class="elocal">sec</span><span class="esymbol">)</span>
				<span class="ekeyword">if</span> <span class="ekeyword">attached</span> <span class="elocal">other</span> <span class="ekeyword">then</span>
					<span class="ekeyword">if</span> <span class="elocal">other</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/sector_t.html#f_ceilingheight">ceilingheight</a> <a class="esymbol" href="../base/integer_32_ref.html#f_is_less">&lt;</a> <span class="ekeyword">Result</span> <span class="ekeyword">then</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">other</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/sector_t.html#f_ceilingheight">ceilingheight</a>
					<span class="ekeyword">end</span>
				<span class="ekeyword">end</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>

	<a name="f_getnextsector"></a><a class="efeature" href="../brie_doom/p_spec.html#f_getnextsector">getnextsector</a> <span class="esymbol">(</span><span class="elocal">line</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/render/line_t.html">LINE_T</a><span class="esymbol">;</span> <span class="elocal">sec</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/render/sector_t.html">SECTOR_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <span class="ekeyword">detachable</span> <a class="eclass" href="../brie_doom/render/sector_t.html">SECTOR_T</a>
			<span class="ecomment">--</span><span class="ecomment"> Return sector_t * of sector next to current.</span>
			<span class="ecomment">--</span><span class="ecomment"> NULL if not two-sided line</span>
		<span class="ekeyword">do</span>
			<span class="ekeyword">if</span> <span class="elocal">line</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/line_t.html#f_flags">flags</a><span class="edot">.</span><a class="efeature" href="../base/integer_16_ref.html#f_to_integer_32">to_integer_32</a> <a class="esymbol" href="../base/integer_32.html#f_bit_and">&#38;</a> <span class="esymbol">{</span><a class="eclass" href="../brie_doom/doomdata_h.html">DOOMDATA_H</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../brie_doom/doomdata_h.html#f_ml_twosided">ml_twosided</a> <span class="esymbol">=</span> <span class="enumber">0</span> <span class="ekeyword">then</span>
				<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="ekeyword">Void</span>
			<span class="ekeyword">else</span>
				<span class="ekeyword">if</span> <span class="elocal">line</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/line_t.html#f_frontsector">frontsector</a> <span class="esymbol">=</span> <span class="elocal">sec</span> <span class="ekeyword">then</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">line</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/line_t.html#f_backsector">backsector</a>
				<span class="ekeyword">else</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">line</span><span class="edot">.</span><a class="efeature" href="../brie_doom/render/line_t.html#f_frontsector">frontsector</a>
				<span class="ekeyword">end</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>

	<a name="f_p_shootspecialline"></a><a class="efeature" href="../brie_doom/p_spec.html#f_p_shootspecialline">p_shootspecialline</a> <span class="esymbol">(</span><span class="elocal">thing</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/mobj_t.html">MOBJ_T</a><span class="esymbol">;</span> <span class="elocal">line</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/render/line_t.html">LINE_T</a><span class="esymbol">)</span>
			<span class="ecomment">--</span><span class="ecomment"> IMPACT SPECIALS</span>
			<span class="ecomment">--</span><span class="ecomment"> Called when a thing shoots a special line.</span>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../base/any.html#f_print">print</a><span class="esymbol"> </span><span class="esymbol">(</span>&quot;P_ShootSpecialLine not implemented%N&quot;<span class="esymbol">)</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> <span class="ecomment">--</span><span class="ecomment"> Special Stuff that can not be categorized</span>

	<a name="f_ev_dodonut"></a><a class="efeature" href="../brie_doom/p_spec.html#f_ev_dodonut">ev_dodonut</a> <span class="esymbol">(</span><span class="elocal">line</span><span class="esymbol">:</span> <a class="eclass" href="../brie_doom/render/line_t.html">LINE_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../base/boolean.html">BOOLEAN</a>
		<span class="ekeyword">do</span>
			<span class="esymbol">{</span><a class="eclass" href="../brie_doom/i_main.html">I_MAIN</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../brie_doom/i_main.html#f_i_error">i_error</a> <span class="esymbol">(</span>&quot;EV_DoDonut not implemented&quot;<span class="esymbol">)</span>
		<span class="ekeyword">ensure</span>
			<span class="etag">instance_free</span><span class="esymbol">:</span> <span class="ekeyword">class</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">end</span> <span class="ecomment">--</span> <span class="ecomment">class </span><a class="eclass" href="../brie_doom/p_spec.html">P_SPEC</a></pre><form class="nav" onsubmit="go_to('../',this.c.value);return false;">
<div class="nav">
<a class="nav hierarchy" href="../class_list.html">Classes</a>
<a class="nav hierarchy" href="../cluster_list.html">Clusters</a>
<a class="nav hierarchy" href="../cluster_hierarchy.html">Cluster hierarchy</a>
<a class="nav class" href="p_spec_chart.html">Chart</a>
<a class="nav class" href="p_spec_links.html">Relations</a>
<span class="nav class selected">Text</span>
<span class="nav class goto">Go to: <input name="c" value="p_spec"></span>
</div></form><pre></pre>
<p style="text-align:center;">Generated by <a href="http://www.eiffel.com">ISE EiffelStudio</a></p>
</body>
</html>

