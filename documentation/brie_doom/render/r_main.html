<!DOCTYPE html>
<html>
<head>
<meta name="robots" content="noindex">
<meta name="generator" content="ISE EiffelStudio version 19.05.10.3187 GPL Edition - linux-x86-64">
<meta name="description" content="r_main.c Rendering main loop and setup functions,  utility functions (BSP, geometry, trigonometry). See tables.c, too"/>
<meta name="license" content="Copyright (C) 1993-1996 by id Software, Inc. Copyright (C) 2005-2014 Simon Howard Copyright (C) 2021 Ilgiz Mustafin  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA."/>
<meta name="keywords" content="Eiffel class"/>
<meta name="keywords" content="Eiffel class"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet">
<title>r_main Text</title>
<link rel="stylesheet" href="../../default.css" type="text/css">
<script type="text/javascript" src="../../goto.html"></script>
</head>
<body>
<pre></pre><form class="nav" onsubmit="go_to('../../',this.c.value);return false;">
<div class="nav">
<a class="nav hierarchy" href="../../class_list.html">Classes</a>
<a class="nav hierarchy" href="../../cluster_list.html">Clusters</a>
<a class="nav hierarchy" href="../../cluster_hierarchy.html">Cluster hierarchy</a>
<a class="nav class" href="r_main_chart.html">Chart</a>
<a class="nav class" href="r_main_links.html">Relations</a>
<span class="nav class selected">Text</span>
<span class="nav class goto">Go to: <input name="c" value="r_main"></span>
</div></form><pre><span class="ekeyword">note</span>
	<span class="eitag">description</span><span class="esymbol">:</span> <span class="estring">&quot;</span><span class="estring">[</span>
		<span class="estring">r_main.c</span>
		<span class="estring">Rendering main loop and setup functions,</span>
		<span class="estring"> utility functions (BSP, geometry, trigonometry).</span>
		<span class="estring">See tables.c, too</span>
	<span class="estring">]</span><span class="estring">&quot;</span>
	<span class="eitag">license</span><span class="esymbol">:</span> <span class="estring">&quot;</span><span class="estring">[</span>
		<span class="estring">Copyright (C) 1993-1996 by id Software, Inc.</span>
		<span class="estring">Copyright (C) 2005-2014 Simon Howard</span>
		<span class="estring">Copyright (C) 2021 Ilgiz Mustafin</span>
		
		<span class="estring">This program is free software; you can redistribute it and/or modify</span>
		<span class="estring">it under the terms of the GNU General Public License as published by</span>
		<span class="estring">the Free Software Foundation; either version 2 of the License, or</span>
		<span class="estring">(at your option) any later version.</span>
		
		<span class="estring">This program is distributed in the hope that it will be useful,</span>
		<span class="estring">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
		<span class="estring">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. &nbsp;See the</span>
		<span class="estring">GNU General Public License for more details.</span>
		
		<span class="estring">You should have received a copy of the GNU General Public License along</span>
		<span class="estring">with this program; if not, write to the Free Software Foundation, Inc.,</span>
		<span class="estring">51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>
	<span class="estring">]</span><span class="estring">&quot;</span>

<span class="ekeyword">class</span> 
	<a class="eclass" href="../../brie_doom/render/r_main.html">R_MAIN</a>

<span class="ekeyword">inherit</span>
	<a class="eclass" href="../../brie_doom/tables.html">TABLES</a>

	<a class="eclass" href="../../brie_doom/doomdef_h.html">DOOMDEF_H</a>

<span class="ekeyword">create</span> 
	<a class="efeature" href="../../brie_doom/render/r_main.html#f_make">make</a>

<span class="ekeyword">feature</span> 

	<a name="f_i_main"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/i_main.html">I_MAIN</a>

	<a name="f_make"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_make">make</a> <span class="esymbol">(</span><span class="elocal">a_i_main</span><span class="esymbol">:</span> <span class="ekeyword">like</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="esymbol">)</span>
		<span class="ekeyword">local</span>
			<span class="elocal">i</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a> <span class="esymbol">:=</span> <span class="elocal">a_i_main</span>
			<span class="ekeyword">create</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewplayer">viewplayer</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/player_t.html#f_make">make</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_validcount">validcount</a> <span class="esymbol">:=</span> <span class="enumber">1</span>
			<span class="ekeyword">create</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelightfixed">scalelightfixed</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_filled">make_filled</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="ekeyword">Void</span><span class="esymbol">,</span> <span class="enumber">0</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightscale">Maxlightscale</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span><span class="esymbol">)</span>
			<span class="ekeyword">create</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_filled">make_filled</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">,</span> <span class="enumber">0</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/tables.html#f_fineangles">Fineangles</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span><span class="esymbol">)</span>
			<span class="ekeyword">from</span>
				<span class="ekeyword">create</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelight">scalelight</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_filled">make_filled</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="ekeyword">create</span><span class="esymbol"> </span><span class="esymbol">{</span><a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><span class="ekeyword">detachable</span> <a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">]</span><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_empty">make_empty</a><span class="esymbol">,</span> <span class="enumber">0</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span><span class="esymbol">)</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a>
			<span class="ekeyword">loop</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelight">scalelight</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span><span class="esymbol"> </span><span class="esymbol">{</span><a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><span class="ekeyword">detachable</span> <a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">]</span><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_filled">make_filled</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="ekeyword">Void</span><span class="esymbol">,</span> <span class="enumber">0</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightscale">Maxlightscale</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span><span class="esymbol">)</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
			<span class="ekeyword">from</span>
				<span class="ekeyword">create</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_zlight">zlight</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_filled">make_filled</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="ekeyword">create</span><span class="esymbol"> </span><span class="esymbol">{</span><a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><span class="ekeyword">detachable</span> <a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">]</span><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_empty">make_empty</a><span class="esymbol">,</span> <span class="enumber">0</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span><span class="esymbol">)</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a>
			<span class="ekeyword">loop</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_zlight">zlight</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span><span class="esymbol"> </span><span class="esymbol">{</span><a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><span class="ekeyword">detachable</span> <a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">]</span><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_filled">make_filled</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="ekeyword">Void</span><span class="esymbol">,</span> <span class="enumber">0</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightz">Maxlightz</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span><span class="esymbol">)</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_viewx"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewx">viewx</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>

	<a name="f_viewy"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewy">viewy</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>

	<a name="f_viewz"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewz">viewz</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
	
<span class="ekeyword">feature</span> 

	<a name="f_viewplayer"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewplayer">viewplayer</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/player_t.html">PLAYER_T</a>

	<a name="f_viewangle"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangle">viewangle</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a>

	<a name="f_viewangleoffset"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangleoffset">viewangleoffset</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>

	<a name="f_extralight"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_extralight">extralight</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>

	<a name="f_viewsin"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewsin">viewsin</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>

	<a name="f_viewcos"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewcos">viewcos</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>

	<a name="f_sscount"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_sscount">sscount</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="ekeyword">assign</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_set_sscount">set_sscount</a>

	<a name="f_set_sscount"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_set_sscount">set_sscount</a> <span class="esymbol">(</span><span class="elocal">a_sscount</span><span class="esymbol">:</span> <span class="ekeyword">like</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_sscount">sscount</a><span class="esymbol">)</span>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_sscount">sscount</a> <span class="esymbol">:=</span> <span class="elocal">a_sscount</span>
		<span class="ekeyword">end</span>

	<a name="f_linecount"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_linecount">linecount</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>

	<a name="f_loopcount"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_loopcount">loopcount</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>

	<a name="f_fixedcolormap"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_fixedcolormap">fixedcolormap</a><span class="esymbol">:</span> <span class="ekeyword">detachable</span> <a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span>
			<span class="ecomment">--</span><span class="ecomment"> lighttable_t*</span>

	<a name="f_scalelightfixed"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelightfixed">scalelightfixed</a><span class="esymbol">:</span> <a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><span class="ekeyword">detachable</span> <a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">]</span>
			<span class="ecomment">--</span><span class="ecomment"> lighttable_t* []</span>

	<a name="f_zlight"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_zlight">zlight</a><span class="esymbol">:</span> <a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><span class="ekeyword">detachable</span> <a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">]</span><span class="esymbol">]</span>
			<span class="ecomment">--</span><span class="ecomment"> ligghttable_t* </span><span class="ecomment">[][]</span>

	<a name="f_validcount"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_validcount">validcount</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="ekeyword">assign</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_set_validcount">set_validcount</a>
			<span class="ecomment">--</span><span class="ecomment"> increment every time a check is made</span>

	<a name="f_set_validcount"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_set_validcount">set_validcount</a> <span class="esymbol">(</span><span class="elocal">a_validcount</span><span class="esymbol">:</span> <span class="ekeyword">like</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_validcount">validcount</a><span class="esymbol">)</span>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_validcount">validcount</a> <span class="esymbol">:=</span> <span class="elocal">a_validcount</span>
		<span class="ekeyword">end</span>

	<a name="f_fieldofview"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_fieldofview">Fieldofview</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">2048</span>
			<span class="ecomment">--</span><span class="ecomment"> Fineangles in the SCREENWIDTH wide window.</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_centerx"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_centerx">centerx</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>

	<a name="f_centery"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_centery">centery</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>

	<a name="f_centerxfrac"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_centerxfrac">centerxfrac</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>

	<a name="f_centeryfrac"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_centeryfrac">centeryfrac</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>

	<a name="f_projection"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_projection">projection</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
	
<span class="ekeyword">feature</span> 

	<a name="f_colfunc"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_colfunc">colfunc</a><span class="esymbol">:</span> <span class="ekeyword">detachable</span> <a class="eclass" href="../../base/procedure.html">PROCEDURE</a> <span class="ekeyword">assign</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_set_colfunc">set_colfunc</a>

	<a name="f_set_colfunc"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_set_colfunc">set_colfunc</a> <span class="esymbol">(</span><span class="elocal">a_colfunc</span><span class="esymbol">:</span> <span class="ekeyword">like</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_colfunc">colfunc</a><span class="esymbol">)</span>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_colfunc">colfunc</a> <span class="esymbol">:=</span> <span class="elocal">a_colfunc</span>
		<span class="ekeyword">end</span>

	<a name="f_basecolfunc"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_basecolfunc">basecolfunc</a><span class="esymbol">:</span> <span class="ekeyword">detachable</span> <a class="eclass" href="../../base/procedure.html">PROCEDURE</a>

	<a name="f_fuzzcolfunc"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_fuzzcolfunc">fuzzcolfunc</a><span class="esymbol">:</span> <span class="ekeyword">detachable</span> <a class="eclass" href="../../base/procedure.html">PROCEDURE</a>

	<a name="f_transcolfunc"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_transcolfunc">transcolfunc</a><span class="esymbol">:</span> <span class="ekeyword">detachable</span> <a class="eclass" href="../../base/procedure.html">PROCEDURE</a>

	<a name="f_spanfunc"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_spanfunc">spanfunc</a><span class="esymbol">:</span> <span class="ekeyword">detachable</span> <a class="eclass" href="../../base/procedure.html">PROCEDURE</a>
	
<span class="ekeyword">feature</span> 

	<a name="f_detailshift"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_detailshift">detailshift</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="ecomment">--</span><span class="ecomment"> 0 = high, 1 = low</span>
	
<span class="ekeyword">feature</span> <span class="ecomment">--</span><span class="ecomment"> Lighting constants.</span>

	<a name="f_lightlevels"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">16</span>

	<a name="f_lightsegshift"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_lightsegshift">Lightsegshift</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">4</span>

	<a name="f_maxlightscale"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightscale">Maxlightscale</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">48</span>

	<a name="f_lightscaleshift"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_lightscaleshift">Lightscaleshift</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">12</span>

	<a name="f_maxlightz"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightz">Maxlightz</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">128</span>

	<a name="f_lightzshift"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_lightzshift">Lightzshift</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">20</span>

	<a name="f_numcolormaps"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_numcolormaps">Numcolormaps</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">32</span>
			<span class="ecomment">--</span><span class="ecomment"> Number of diminishing brightness levels.</span>
			<span class="ecomment">--</span><span class="ecomment"> There a 0-31, i.e. 32 LUT in the COLORMAP lump.</span>

	<a name="f_scalelight"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelight">scalelight</a><span class="esymbol">:</span> <a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><span class="ekeyword">detachable</span> <a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">]</span><span class="esymbol">]</span>
			<span class="ecomment">--</span><span class="ecomment"> lighttable_t* </span><span class="ecomment">[][]</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_finecosine"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_finecosine">Finecosine</a><span class="esymbol">:</span> <a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">]</span>
		<span class="ekeyword">local</span>
			<span class="elocal">l_start</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">i</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">once</span>
			<span class="elocal">l_start</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_fineangles">Fineangles</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">4</span>
			<span class="ekeyword">create</span> <span class="ekeyword">Result</span><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_filled">make_filled</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span><span class="esymbol">,</span> <span class="enumber">0</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/tables.html#f_finesine">Finesine</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_count">count</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="elocal">l_start</span> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span><span class="esymbol">)</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="ekeyword">Result</span><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_upper">upper</a>
			<span class="ekeyword">loop</span>
				<span class="ekeyword">Result</span> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/tables.html#f_finesine">Finesine</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="elocal">l_start</span><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="esymbol">)</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">ensure</span>
			<span class="etag">instance_free</span><span class="esymbol">:</span> <span class="ekeyword">class</span>
		<span class="ekeyword">end</span>

	<a name="f_xtoviewangle"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_xtoviewangle">Xtoviewangle</a><span class="esymbol">:</span> <a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">]</span>
			<span class="ecomment">--</span><span class="ecomment"> maps a screen pixel</span>
			<span class="ecomment">--</span><span class="ecomment"> to the lowest viewangle that maps back to x ranges</span>
			<span class="ecomment">--</span><span class="ecomment"> from clipangle to -clipangle</span>
		<span class="ekeyword">once</span>
			<span class="ekeyword">create</span> <span class="ekeyword">Result</span><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_make_filled">make_filled</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/angle_t.html#f_from_natural">from_natural</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../base/natural_32.html">NATURAL_32</a><span class="esymbol">}</span> <span class="enumber">0</span><span class="esymbol">)</span><span class="esymbol">,</span> <span class="enumber">0</span><span class="esymbol">,</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/doomdef_h.html">DOOMDEF_H</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/doomdef_h.html#f_screenwidth">screenwidth</a><span class="esymbol">)</span>
		<span class="ekeyword">end</span>

	<a name="f_r_pointonsegside"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_pointonsegside">r_pointonsegside</a> <span class="esymbol">(</span><span class="elocal">x</span><span class="esymbol">,</span> <span class="elocal">y</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">;</span> <span class="elocal">line</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/render/seg_t.html">SEG_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">local</span>
			<span class="elocal">lx</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">ly</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">ldx</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">ldy</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">dx</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">dy</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">left</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">right</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
		<span class="ekeyword">do</span>
			<span class="elocal">lx</span> <span class="esymbol">:=</span> <span class="elocal">line</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/seg_t.html#f_v1">v1</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/vertex_t.html#f_x">x</a>
			<span class="elocal">ly</span> <span class="esymbol">:=</span> <span class="elocal">line</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/seg_t.html#f_v1">v1</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/vertex_t.html#f_y">y</a>
			<span class="elocal">ldx</span> <span class="esymbol">:=</span> <span class="elocal">line</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/seg_t.html#f_v2">v2</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/vertex_t.html#f_x">x</a> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <span class="elocal">lx</span>
			<span class="elocal">ldy</span> <span class="esymbol">:=</span> <span class="elocal">line</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/seg_t.html#f_v2">v2</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/vertex_t.html#f_y">y</a> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <span class="elocal">ly</span>
			<span class="ekeyword">if</span> <span class="elocal">ldx</span> <span class="esymbol">=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
				<span class="ekeyword">if</span> <span class="elocal">x</span> <a class="esymbol" href="../../base/comparable.html#f_is_less_equal">&lt;=</a> <span class="elocal">lx</span> <span class="ekeyword">then</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="elocal">ldy</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/boolean_ref.html#f_to_integer">to_integer</a>
				<span class="ekeyword">else</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="elocal">ldy</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_is_less">&lt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/boolean_ref.html#f_to_integer">to_integer</a>
				<span class="ekeyword">end</span>
			<span class="ekeyword">elseif</span> <span class="elocal">ldy</span> <span class="esymbol">=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
				<span class="ekeyword">if</span> <span class="elocal">y</span> <a class="esymbol" href="../../base/comparable.html#f_is_less_equal">&lt;=</a> <span class="elocal">ly</span> <span class="ekeyword">then</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="elocal">ldx</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_is_less">&lt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/boolean_ref.html#f_to_integer">to_integer</a>
				<span class="ekeyword">else</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="elocal">ldx</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/boolean_ref.html#f_to_integer">to_integer</a>
				<span class="ekeyword">end</span>
			<span class="ekeyword">else</span>
				<span class="elocal">dx</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="elocal">x</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <span class="elocal">lx</span><span class="esymbol">)</span>
				<span class="elocal">dy</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="elocal">y</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <span class="elocal">ly</span><span class="esymbol">)</span>
				<span class="ekeyword">if</span> <span class="esymbol">(</span><span class="elocal">ldy</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_bit_xor">bit_xor</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">ldx</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_bit_xor">bit_xor</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">dx</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_bit_xor">bit_xor</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">dy</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_and">&#38;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="enumber">2147483648</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_64_ref.html#f_to_integer_32">to_integer_32</a><span class="esymbol">)</span><span class="esymbol">)</span> <span class="esymbol">/=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
					<span class="ekeyword">if</span> <span class="esymbol">(</span><span class="elocal">ldy</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_bit_xor">bit_xor</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">dx</span><span class="esymbol">)</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_and">&#38;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="enumber">2147483648</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_64_ref.html#f_to_integer_32">to_integer_32</a><span class="esymbol">)</span> <span class="esymbol">/=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="enumber">1</span>
					<span class="ekeyword">else</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
					<span class="ekeyword">end</span>
				<span class="ekeyword">else</span>
					<span class="elocal">left</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixedmul">fixedmul</a> <span class="esymbol">(</span><span class="elocal">ldy</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracbits">fracbits</a><span class="esymbol">,</span> <span class="elocal">dx</span><span class="esymbol">)</span>
					<span class="elocal">right</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixedmul">fixedmul</a> <span class="esymbol">(</span><span class="elocal">dy</span><span class="esymbol">,</span> <span class="elocal">ldx</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracbits">fracbits</a><span class="esymbol">)</span>
					<span class="ekeyword">if</span> <span class="elocal">right</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_is_less">&lt;</a> <span class="elocal">left</span> <span class="ekeyword">then</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
					<span class="ekeyword">else</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="enumber">1</span>
					<span class="ekeyword">end</span>
				<span class="ekeyword">end</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> <span class="ecomment">--</span><span class="ecomment"> R_SetViewSize</span>

	<a name="f_setsizeneeded"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_setsizeneeded">setsizeneeded</a><span class="esymbol">:</span> <a class="eclass" href="../../base/boolean.html">BOOLEAN</a>

	<a name="f_setblocks"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_setblocks">setblocks</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>

	<a name="f_setdetail"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_setdetail">setdetail</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>

	<a name="f_r_setviewsize"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_setviewsize">r_setviewsize</a> <span class="esymbol">(</span><span class="elocal">blocks</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a><span class="esymbol">;</span> <span class="elocal">detail</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a><span class="esymbol">)</span>
			<span class="ecomment">--</span><span class="ecomment"> Do not really change anything here,</span>
			<span class="ecomment">--</span><span class="ecomment"> &nbsp;because it might be in the middle of a refresh.</span>
			<span class="ecomment">--</span><span class="ecomment"> The change will take effect next refresh.</span>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_setsizeneeded">setsizeneeded</a> <span class="esymbol">:=</span> <span class="ekeyword">True</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_setblocks">setblocks</a> <span class="esymbol">:=</span> <span class="elocal">blocks</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_setdetail">setdetail</a> <span class="esymbol">:=</span> <span class="elocal">detail</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> <span class="ecomment">--</span><span class="ecomment"> precalculated math tables</span>

	<a name="f_clipangle"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_clipangle">clipangle</a><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a>

	<a name="f_viewangletox"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a><span class="esymbol">:</span> <a class="eclass" href="../../base/array.html">ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../base/integer_32.html">INTEGER_32</a><span class="esymbol">]</span>
			<span class="ecomment">--</span><span class="ecomment"> The viewangletox[viewangle + FINEANGLES/4] lookup</span>
			<span class="ecomment">--</span><span class="ecomment"> maps the visible view angles to screen X coordinates,</span>
			<span class="ecomment">--</span><span class="ecomment"> flattening the arc to a flat projection plane.</span>
			<span class="ecomment">--</span><span class="ecomment"> There will be many angles mapped to the same X.</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_r_scalefromglobalangle"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_scalefromglobalangle">r_scalefromglobalangle</a> <span class="esymbol">(</span><span class="elocal">visangle</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="ecomment">--</span><span class="ecomment"> Returns the texture mapping scale</span>
			<span class="ecomment">--</span><span class="ecomment"> for the current line (horizontal span)</span>
			<span class="ecomment">--</span><span class="ecomment"> at the given angle.</span>
			<span class="ecomment">--</span><span class="ecomment"> rw_distance must be calculated first</span>
		<span class="ekeyword">local</span>
			<span class="elocal">scale</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">anglea</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a>
			<span class="elocal">angleb</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a>
			<span class="elocal">sinea</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">sineb</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">num</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">den</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">do</span>
			<span class="elocal">anglea</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_ang90">Ang90</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_plus">+</a> <span class="esymbol">(</span><span class="elocal">visangle</span> <a class="esymbol" href="../../base/natural_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangle">viewangle</a><span class="esymbol">)</span>
			<span class="elocal">angleb</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_ang90">Ang90</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_plus">+</a> <span class="esymbol">(</span><span class="elocal">visangle</span> <a class="esymbol" href="../../base/natural_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_segs">R_segs</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_segs.html#f_rw_normalangle">rw_normalangle</a><span class="esymbol">)</span>
			<span class="elocal">sinea</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_finesine">Finesine</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">anglea</span> <a class="esymbol" href="../../base/natural_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/tables.html#f_angletofineshift">Angletofineshift</a><span class="edot">.</span><a class="efeature" href="../../base/natural_32_ref.html#f_as_integer_32">as_integer_32</a><a class="esymbol" href="../../base/array.html#f_item">]</a>
			<span class="elocal">sineb</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_finesine">Finesine</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">angleb</span> <a class="esymbol" href="../../base/natural_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/tables.html#f_angletofineshift">Angletofineshift</a><span class="edot">.</span><a class="efeature" href="../../base/natural_32_ref.html#f_as_integer_32">as_integer_32</a><a class="esymbol" href="../../base/array.html#f_item">]</a>
			<span class="elocal">num</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixedmul">fixedmul</a> <span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_projection">projection</a><span class="esymbol">,</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">sineb</span><span class="esymbol">)</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_shift_left">|&lt;&lt;</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_detailshift">detailshift</a>
			<span class="elocal">den</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixedmul">fixedmul</a> <span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_segs">R_segs</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_segs.html#f_rw_distance">rw_distance</a><span class="esymbol">,</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">sinea</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_integer_32">to_integer_32</a>
			<span class="ekeyword">if</span> <span class="elocal">den</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="elocal">num</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <span class="enumber">16</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_integer_32">as_integer_32</a> <span class="ekeyword">then</span>
				<span class="elocal">scale</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixeddiv">fixeddiv</a> <span class="esymbol">(</span><span class="elocal">num</span><span class="esymbol">,</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">den</span><span class="esymbol">)</span><span class="esymbol">)</span>
				<span class="ekeyword">if</span> <span class="elocal">scale</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">64</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a><span class="esymbol">)</span> <span class="ekeyword">then</span>
					<span class="elocal">scale</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">64</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a><span class="esymbol">)</span>
				<span class="ekeyword">elseif</span> <span class="elocal">scale</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_is_less">&lt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">256</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
					<span class="elocal">scale</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">256</span><span class="esymbol">)</span>
				<span class="ekeyword">end</span>
			<span class="ekeyword">else</span>
				<span class="elocal">scale</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">64</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a><span class="esymbol">)</span>
			<span class="ekeyword">end</span>
			<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">scale</span>
		<span class="ekeyword">end</span>

	<a name="f_r_executesetviewsize"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_executesetviewsize">r_executesetviewsize</a>
		<span class="ekeyword">local</span>
			<span class="elocal">cosadj</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">dy</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">i</span><span class="esymbol">,</span> <span class="elocal">j</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">level</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">startmap</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_setsizeneeded">setsizeneeded</a> <span class="esymbol">:=</span> <span class="ekeyword">False</span>
			<span class="ekeyword">if</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_setblocks">setblocks</a> <span class="esymbol">=</span> <span class="enumber">11</span> <span class="ekeyword">then</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_scaledviewwidth">scaledviewwidth</a> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/doomdef_h.html">DOOMDEF_H</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/doomdef_h.html#f_screenwidth">screenwidth</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewheight">viewheight</a> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/doomdef_h.html">DOOMDEF_H</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/doomdef_h.html#f_screenheight">screenheight</a>
			<span class="ekeyword">else</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_scaledviewwidth">scaledviewwidth</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_setblocks">setblocks</a> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="enumber">32</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewheight">viewheight</a> <span class="esymbol">:=</span> <span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_setblocks">setblocks</a> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="enumber">168</span> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">10</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32.html#f_bit_and">bit_and</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="enumber">7</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32.html#f_bit_not">bit_not</a><span class="esymbol">)</span>
			<span class="ekeyword">end</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_detailshift">detailshift</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_setdetail">setdetail</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_scaledviewwidth">scaledviewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_detailshift">detailshift</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_centery">centery</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewheight">viewheight</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_centerx">centerx</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_centerxfrac">centerxfrac</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_centerx">centerx</a> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_left">|&lt;&lt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracbits">fracbits</a><span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_centeryfrac">centeryfrac</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_centery">centery</a> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_left">|&lt;&lt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracbits">fracbits</a><span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_projection">projection</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_centerxfrac">centerxfrac</a>
			<span class="ekeyword">if</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_detailshift">detailshift</a> <span class="esymbol">=</span> <span class="enumber">0</span> <span class="ekeyword">then</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_colfunc">colfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawcolumn">r_drawcolumn</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_basecolfunc">basecolfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawcolumn">r_drawcolumn</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_transcolfunc">transcolfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawtranslatedcolumn">r_drawtranslatedcolumn</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_spanfunc">spanfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawspan">r_drawspan</a>
			<span class="ekeyword">else</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_colfunc">colfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawcolumnlow">r_drawcolumnlow</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_basecolfunc">basecolfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawcolumnlow">r_drawcolumnlow</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_fuzzcolfunc">fuzzcolfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawfuzzcolumn">r_drawfuzzcolumn</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_transcolfunc">transcolfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawtranslatedcolumn">r_drawtranslatedcolumn</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_spanfunc">spanfunc</a> <span class="esymbol">:=</span> <span class="ekeyword">agent</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_drawspanlow">r_drawspanlow</a>
			<span class="ekeyword">end</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_initbuffer">r_initbuffer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_scaledviewwidth">scaledviewwidth</a><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewheight">viewheight</a><span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_r_inittexturemapping">r_inittexturemapping</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_things">R_things</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_things.html#f_pspritescale">pspritescale</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <a class="efeature" href="../../brie_doom/doomdef_h.html#f_screenwidth">Screenwidth</a><span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_things">R_things</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_things.html#f_pspriteiscale">pspriteiscale</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <a class="efeature" href="../../brie_doom/doomdef_h.html#f_screenwidth">Screenwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a><span class="esymbol">)</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a>
			<span class="ekeyword">loop</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_things">R_things</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_things.html#f_screenheightarray">screenheightarray</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewheight">viewheight</a><span class="edot">.</span><a class="efeature" href="../../base/integer_32.html#f_as_integer_16">as_integer_16</a>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewheight">viewheight</a>
			<span class="ekeyword">loop</span>
				<span class="elocal">dy</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="esymbol">(</span><span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewheight">viewheight</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_left">|&lt;&lt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracbits">fracbits</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span><span class="esymbol">)</span>
				<span class="elocal">dy</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">dy</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_abs">abs</a><span class="esymbol">)</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_plane">R_plane</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_plane.html#f_yslope">Yslope</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixeddiv">fixeddiv</a> <span class="esymbol">(</span><span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_left">|&lt;&lt;</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_detailshift">detailshift</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a><span class="esymbol">)</span><span class="esymbol">,</span> <span class="elocal">dy</span><span class="esymbol">)</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a>
			<span class="ekeyword">loop</span>
				<span class="elocal">cosadj</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_finecosine">Finecosine</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/render/r_main.html#f_xtoviewangle">Xtoviewangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/tables.html#f_angletofineshift">Angletofineshift</a><span class="edot">.</span><a class="efeature" href="../../base/natural_32_ref.html#f_as_integer_32">as_integer_32</a><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_abs">abs</a><span class="esymbol">)</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_plane">R_plane</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_plane.html#f_distscale">Distscale</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixeddiv">fixeddiv</a> <span class="esymbol">(</span><span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a><span class="esymbol">)</span><span class="esymbol">,</span> <span class="elocal">cosadj</span><span class="esymbol">)</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a>
			<span class="ekeyword">loop</span>
				<span class="elocal">startmap</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="elocal">i</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="enumber">2</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_numcolormaps">Numcolormaps</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a>
				<span class="ekeyword">from</span>
					<span class="elocal">j</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
				<span class="ekeyword">until</span>
					<span class="elocal">j</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightscale">Maxlightscale</a>
				<span class="ekeyword">loop</span>
					<span class="elocal">level</span> <span class="esymbol">:=</span> <span class="elocal">startmap</span> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="elocal">j</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <a class="efeature" href="../../brie_doom/doomdef_h.html#f_screenwidth">Screenwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_left">|&lt;&lt;</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_detailshift">detailshift</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_distmap">Distmap</a>
					<span class="ekeyword">if</span> <span class="elocal">level</span> <a class="esymbol" href="../../base/integer_32.html#f_is_less">&lt;</a> <span class="enumber">0</span> <span class="ekeyword">then</span>
						<span class="elocal">level</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
					<span class="ekeyword">end</span>
					<span class="ekeyword">if</span> <span class="elocal">level</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_numcolormaps">Numcolormaps</a> <span class="ekeyword">then</span>
						<span class="elocal">level</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_numcolormaps">Numcolormaps</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span>
					<span class="ekeyword">end</span>
					<a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelight">scalelight</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">j</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span><span class="esymbol"> </span><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/pointers/index_in_array.html#f_make">make</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">level</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="enumber">256</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_data">R_data</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_data.html#f_colormaps">colormaps</a><span class="esymbol">)</span>
					<span class="elocal">j</span> <span class="esymbol">:=</span> <span class="elocal">j</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
				<span class="ekeyword">end</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_r_initpointtoangle"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_initpointtoangle">r_initpointtoangle</a>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<a name="f_r_inittables"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_inittables">r_inittables</a>
		<span class="ekeyword">do</span>
		<span class="ekeyword">end</span>

	<a name="f_r_pointtodist"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_pointtodist">r_pointtodist</a> <span class="esymbol">(</span><span class="elocal">x</span><span class="esymbol">,</span> <span class="elocal">y</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
		<span class="ekeyword">local</span>
			<span class="elocal">angle</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">dx</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">dy</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">temp</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">dist</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
		<span class="ekeyword">do</span>
			<span class="elocal">dx</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="elocal">x</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewx">viewx</a><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_abs">abs</a><span class="esymbol">)</span>
			<span class="elocal">dy</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="elocal">y</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewy">viewy</a><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_abs">abs</a><span class="esymbol">)</span>
			<span class="ekeyword">if</span> <span class="elocal">dy</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="elocal">dx</span> <span class="ekeyword">then</span>
				<span class="elocal">temp</span> <span class="esymbol">:=</span> <span class="elocal">dx</span>
				<span class="elocal">dx</span> <span class="esymbol">:=</span> <span class="elocal">dy</span>
				<span class="elocal">dy</span> <span class="esymbol">:=</span> <span class="elocal">temp</span>
			<span class="ekeyword">end</span>
			<span class="elocal">angle</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixeddiv">fixeddiv</a> <span class="esymbol">(</span><span class="elocal">dy</span><span class="esymbol">,</span> <span class="elocal">dx</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_integer_32">to_integer_32</a> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/tables.html#f_dbits">Dbits</a><a class="esymbol" href="../../base/array.html#f_item">]</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_plus">+</a> <a class="efeature" href="../../brie_doom/tables.html#f_ang90">Ang90</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/natural_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/tables.html#f_angletofineshift">Angletofineshift</a><span class="edot">.</span><a class="efeature" href="../../base/natural_32_ref.html#f_as_integer_32">as_integer_32</a>
			<span class="elocal">dist</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixeddiv">fixeddiv</a> <span class="esymbol">(</span><span class="elocal">dx</span><span class="esymbol">,</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/tables.html#f_finesine">Finesine</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">angle</span><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="esymbol">)</span><span class="esymbol">)</span>
			<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">dist</span>
		<span class="ekeyword">end</span>

	<a name="f_r_inittexturemapping"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_inittexturemapping">r_inittexturemapping</a>
		<span class="ekeyword">local</span>
			<span class="elocal">i</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">x</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">t</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">focallength</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
		<span class="ekeyword">do</span>
			<span class="elocal">focallength</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixeddiv">fixeddiv</a> <span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_centerxfrac">centerxfrac</a><span class="esymbol">,</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/tables.html">TABLES</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/tables.html#f_finetangent">finetangent</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_fineangles">Fineangles</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">4</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/render/r_main.html">R_MAIN</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_fieldofview">fieldofview</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="esymbol">)</span><span class="esymbol">)</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/tables.html#f_fineangles">Fineangles</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span>
			<span class="ekeyword">loop</span>
				<span class="ekeyword">if</span> <a class="efeature" href="../../brie_doom/tables.html#f_finetangent">Finetangent</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="enumber">2</span> <span class="ekeyword">then</span>
					<span class="elocal">t</span> <span class="esymbol">:=</span> <span class="enumber">-1</span>
				<span class="ekeyword">elseif</span> <a class="efeature" href="../../brie_doom/tables.html#f_finetangent">Finetangent</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <a class="esymbol" href="../../base/integer_32.html#f_is_less">&lt;</a> <a class="esymbol" href="../../base/integer_32.html#f_opposite">-</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="enumber">2</span> <span class="ekeyword">then</span>
					<span class="elocal">t</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
				<span class="ekeyword">else</span>
					<span class="elocal">t</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixedmul">fixedmul</a> <span class="esymbol">(</span><span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/tables.html#f_finetangent">Finetangent</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="esymbol">)</span><span class="esymbol">,</span> <span class="elocal">focallength</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_integer_32">to_integer_32</a>
					<span class="elocal">t</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_centerxfrac">centerxfrac</a> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">t</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_plus">+</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">1</span><span class="esymbol">)</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracbits">fracbits</a><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_integer_32">to_integer_32</a>
					<span class="ekeyword">if</span> <span class="elocal">t</span> <a class="esymbol" href="../../base/integer_32.html#f_is_less">&lt;</a> <span class="enumber">-1</span> <span class="ekeyword">then</span>
						<span class="elocal">t</span> <span class="esymbol">:=</span> <span class="enumber">-1</span>
					<span class="ekeyword">elseif</span> <span class="elocal">t</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span> <span class="ekeyword">then</span>
						<span class="elocal">t</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
					<span class="ekeyword">end</span>
				<span class="ekeyword">end</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="elocal">t</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
			<span class="ekeyword">from</span>
				<span class="elocal">x</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">x</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a>
			<span class="ekeyword">loop</span>
				<span class="ekeyword">from</span>
					<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
				<span class="ekeyword">until</span>
					<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <a class="esymbol" href="../../base/comparable.html#f_is_less_equal">&lt;=</a> <span class="elocal">x</span>
				<span class="ekeyword">loop</span>
					<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
				<span class="ekeyword">end</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_xtoviewangle">Xtoviewangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">x</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/angle_t.html#f_from_natural">from_natural</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="esymbol">(</span><span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_left">|&lt;&lt;</a> <a class="efeature" href="../../brie_doom/tables.html#f_angletofineshift">Angletofineshift</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/tables.html#f_ang90">Ang90</a><span class="edot">.</span><a class="efeature" href="../../base/natural_32_ref.html#f_as_integer_32">as_integer_32</a><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_natural_32">to_natural_32</a><span class="esymbol">)</span>
				<span class="elocal">x</span> <span class="esymbol">:=</span> <span class="elocal">x</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/tables.html#f_fineangles">Fineangles</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span>
			<span class="ekeyword">loop</span>
				<span class="elocal">t</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixedmul">fixedmul</a> <span class="esymbol">(</span><span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/tables.html#f_finetangent">Finetangent</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="esymbol">)</span><span class="esymbol">,</span> <span class="elocal">focallength</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_integer_32">to_integer_32</a>
				<span class="elocal">t</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_centerx">centerx</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="elocal">t</span>
				<span class="ekeyword">if</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">=</span> <span class="enumber">-1</span> <span class="ekeyword">then</span>
					<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="enumber">0</span>
				<span class="ekeyword">elseif</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span> <span class="ekeyword">then</span>
					<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_viewwidth">viewwidth</a>
				<span class="ekeyword">end</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_clipangle">clipangle</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_xtoviewangle">Xtoviewangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="enumber">0</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> <span class="ecomment">--</span><span class="ecomment"> R_InitLightTables</span>

	<a name="f_distmap"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_distmap">Distmap</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a> <span class="esymbol">=</span> <span class="enumber">2</span>

	<a name="f_r_initlighttables"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_initlighttables">r_initlighttables</a>
			<span class="ecomment">--</span><span class="ecomment"> Only inits the zlight table,</span>
			<span class="ecomment">--</span><span class="ecomment"> because the scalelight table changes with view size</span>
		<span class="ekeyword">local</span>
			<span class="elocal">i</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">j</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">level</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">startmap</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">scale</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">do</span>
			<span class="ekeyword">from</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">until</span>
				<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a>
			<span class="ekeyword">loop</span>
				<span class="elocal">startmap</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="elocal">i</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="enumber">2</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_numcolormaps">Numcolormaps</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a>
				<span class="ekeyword">from</span>
					<span class="elocal">j</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
				<span class="ekeyword">until</span>
					<span class="elocal">j</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightz">Maxlightz</a>
				<span class="ekeyword">loop</span>
					<span class="elocal">scale</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixeddiv">fixeddiv</a> <span class="esymbol">(</span><span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/doomdef_h.html#f_screenwidth">Screenwidth</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracunit">fracunit</a><span class="esymbol">)</span><span class="esymbol">,</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="elocal">j</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_left">|&lt;&lt;</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightzshift">Lightzshift</a><span class="esymbol">)</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_integer_32">to_integer_32</a>
					<span class="elocal">scale</span> <span class="esymbol">:=</span> <span class="elocal">scale</span> <a class="esymbol" href="../../base/integer_32.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightscaleshift">Lightscaleshift</a>
					<span class="elocal">level</span> <span class="esymbol">:=</span> <span class="elocal">startmap</span> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="elocal">scale</span> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_distmap">Distmap</a>
					<span class="ekeyword">if</span> <span class="elocal">level</span> <a class="esymbol" href="../../base/integer_32.html#f_is_less">&lt;</a> <span class="enumber">0</span> <span class="ekeyword">then</span>
						<span class="elocal">level</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
					<span class="ekeyword">end</span>
					<span class="ekeyword">if</span> <span class="elocal">level</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_numcolormaps">Numcolormaps</a> <span class="ekeyword">then</span>
						<span class="elocal">level</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_numcolormaps">Numcolormaps</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span>
					<span class="ekeyword">end</span>
					<a class="efeature" href="../../brie_doom/render/r_main.html#f_zlight">zlight</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">j</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span><span class="esymbol"> </span><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/pointers/index_in_array.html#f_make">make</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">level</span> <a class="esymbol" href="../../base/integer_32.html#f_product">*</a> <span class="enumber">256</span><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_data">R_data</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_data.html#f_colormaps">colormaps</a><span class="esymbol">)</span>
					<span class="elocal">j</span> <span class="esymbol">:=</span> <span class="elocal">j</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
				<span class="ekeyword">end</span>
				<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> <span class="ecomment">--</span><span class="ecomment"> R_Init</span>

	<a name="f_framecount"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_framecount">framecount</a><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="ecomment">--</span><span class="ecomment"> just for profiling purposes</span>

	<a name="f_r_init"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_init">r_init</a>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_data">R_data</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_data.html#f_r_initdata">r_initdata</a>
			<a class="efeature" href="../../base/any.html#f_print">print</a><span class="esymbol"> </span><span class="esymbol">(</span>&quot;%NR_InitData&quot;<span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_r_initpointtoangle">r_initpointtoangle</a>
			<a class="efeature" href="../../base/any.html#f_print">print</a><span class="esymbol"> </span><span class="esymbol">(</span>&quot;%NR_InitPointToAngle&quot;<span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_r_inittables">r_inittables</a>
			<a class="efeature" href="../../base/any.html#f_print">print</a><span class="esymbol"> </span><span class="esymbol">(</span>&quot;%NR_InitTables&quot;<span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_r_setviewsize">r_setviewsize</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_m_menu">M_menu</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/m_menu.html#f_screenblocks">screenblocks</a><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_m_menu">M_menu</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/m_menu.html#f_detaillevel">detaillevel</a><span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_plane">R_plane</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_plane.html#f_r_initplanes">r_initplanes</a>
			<a class="efeature" href="../../base/any.html#f_print">print</a><span class="esymbol"> </span><span class="esymbol">(</span>&quot;%NR_InitPlanes&quot;<span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_r_initlighttables">r_initlighttables</a>
			<a class="efeature" href="../../base/any.html#f_print">print</a><span class="esymbol"> </span><span class="esymbol">(</span>&quot;%NR_InitLightTables&quot;<span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_sky">R_sky</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/r_sky.html#f_r_initskymap">r_initskymap</a>
			<a class="efeature" href="../../base/any.html#f_print">print</a><span class="esymbol"> </span><span class="esymbol">(</span>&quot;%NR_InitSkyMap&quot;<span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_draw">R_draw</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_draw.html#f_r_inittranslationtables">r_inittranslationtables</a>
			<a class="efeature" href="../../base/any.html#f_print">print</a><span class="esymbol"> </span><span class="esymbol">(</span>&quot;%NR_InitTranslationsTables&quot;<span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_framecount">framecount</a> <span class="esymbol">:=</span> <span class="enumber">0</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_r_pointtoangle2"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_pointtoangle2">r_pointtoangle2</a> <span class="esymbol">(</span><span class="elocal">x1</span><span class="esymbol">,</span> <span class="elocal">y1</span><span class="esymbol">,</span> <span class="elocal">x2</span><span class="esymbol">,</span> <span class="elocal">y2</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewx">viewx</a> <span class="esymbol">:=</span> <span class="elocal">x1</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewy">viewy</a> <span class="esymbol">:=</span> <span class="elocal">y1</span>
			<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_r_pointtoangle">r_pointtoangle</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">x2</span><span class="esymbol">,</span> <span class="elocal">y2</span><span class="esymbol">)</span>
		<span class="ekeyword">end</span>

	<a name="f_r_pointtoangle"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_pointtoangle">r_pointtoangle</a> <span class="esymbol">(</span><span class="elocal">a_x</span><span class="esymbol">,</span> <span class="elocal">a_y</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a>
			<span class="ecomment">--</span><span class="ecomment"> To get a global angle from cartesian coordinates,</span>
			<span class="ecomment">--</span><span class="ecomment"> &nbsp;the coordinates are flipped until they are in</span>
			<span class="ecomment">--</span><span class="ecomment"> &nbsp;the first octant of the coordinate system, then</span>
			<span class="ecomment">--</span><span class="ecomment"> &nbsp;the y (&lt;= x) is scaled and divided by x to get a</span>
			<span class="ecomment">--</span><span class="ecomment"> &nbsp;tangent (slope) value which is looked up in the</span>
			<span class="ecomment">--</span><span class="ecomment"> &nbsp;tantoangle[] table.</span>
		<span class="ekeyword">local</span>
			<span class="elocal">x</span><span class="esymbol">,</span> <span class="elocal">y</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
		<span class="ekeyword">do</span>
			<span class="elocal">x</span> <span class="esymbol">:=</span> <span class="elocal">a_x</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewx">viewx</a>
			<span class="elocal">y</span> <span class="esymbol">:=</span> <span class="elocal">a_y</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_viewy">viewy</a>
			<span class="ekeyword">if</span> <span class="elocal">x</span> <span class="esymbol">=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <a class="ekeyword" href="../../base/boolean.html#f_conjuncted">and</a> <span class="elocal">y</span> <span class="esymbol">=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
				<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/angle_t.html#f_from_natural">from_natural</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../base/natural_32.html">NATURAL_32</a><span class="esymbol">}</span> <span class="enumber">0</span><span class="esymbol">)</span>
			<span class="ekeyword">else</span>
				<span class="ekeyword">if</span> <span class="elocal">x</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
					<span class="ekeyword">if</span> <span class="elocal">y</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
						<span class="ekeyword">if</span> <span class="elocal">x</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="elocal">y</span> <span class="ekeyword">then</span>
							<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_slopediv">slopediv</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">y</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">,</span> <span class="elocal">x</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
						<span class="ekeyword">else</span>
							<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_ang90">Ang90</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_minus">-</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/angle_t.html#f_from_natural">from_natural</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="enumber">1</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/natural_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_slopediv">slopediv</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">x</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">,</span> <span class="elocal">y</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
						<span class="ekeyword">end</span>
					<span class="ekeyword">else</span>
						<span class="elocal">y</span> <span class="esymbol">:=</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_opposite">-</a> <span class="elocal">y</span>
						<span class="ekeyword">if</span> <span class="elocal">x</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="elocal">y</span> <span class="ekeyword">then</span>
							<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="esymbol" href="../../brie_doom/math/angle_t.html#f_flip_sign">-</a> <a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_slopediv">slopediv</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">y</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">,</span> <span class="elocal">x</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
						<span class="ekeyword">else</span>
							<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/angle_t.html#f_from_natural">from_natural</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/tables.html#f_ang270">Ang270</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_plus">+</a> <a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_slopediv">slopediv</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">x</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">,</span> <span class="elocal">y</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/natural_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span>
						<span class="ekeyword">end</span>
					<span class="ekeyword">end</span>
				<span class="ekeyword">else</span>
					<span class="elocal">x</span> <span class="esymbol">:=</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_opposite">-</a> <span class="elocal">x</span>
					<span class="ekeyword">if</span> <span class="elocal">y</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
						<span class="ekeyword">if</span> <span class="elocal">x</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="elocal">y</span> <span class="ekeyword">then</span>
							<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_ang180">Ang180</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_minus">-</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/angle_t.html#f_from_natural">from_natural</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="enumber">1</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/natural_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_slopediv">slopediv</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">y</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">,</span> <span class="elocal">x</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
						<span class="ekeyword">else</span>
							<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_ang90">Ang90</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_plus">+</a> <a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_slopediv">slopediv</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">x</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">,</span> <span class="elocal">y</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
						<span class="ekeyword">end</span>
					<span class="ekeyword">else</span>
						<span class="elocal">y</span> <span class="esymbol">:=</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_opposite">-</a> <span class="elocal">y</span>
						<span class="ekeyword">if</span> <span class="elocal">x</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="elocal">y</span> <span class="ekeyword">then</span>
							<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_ang180">Ang180</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_plus">+</a> <a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_slopediv">slopediv</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">y</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">,</span> <span class="elocal">x</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
						<span class="ekeyword">else</span>
							<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/tables.html#f_ang270">Ang270</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_minus">-</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/angle_t.html#f_from_natural">from_natural</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="enumber">1</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span> <a class="esymbol" href="../../base/natural_32_ref.html#f_minus">-</a> <a class="efeature" href="../../brie_doom/tables.html#f_tantoangle">Tantoangle</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/tables.html#f_slopediv">slopediv</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">x</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">,</span> <span class="elocal">y</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_as_natural_32">as_natural_32</a><span class="esymbol">)</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
						<span class="ekeyword">end</span>
					<span class="ekeyword">end</span>
				<span class="ekeyword">end</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_r_renderplayerview"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_renderplayerview">r_renderplayerview</a> <span class="esymbol">(</span><span class="elocal">player</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/player_t.html">PLAYER_T</a><span class="esymbol">)</span>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_r_setupframe">r_setupframe</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">player</span><span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_bsp">R_bsp</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_bsp.html#f_r_clearclipsegs">r_clearclipsegs</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_bsp">R_bsp</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_bsp.html#f_r_cleardrawsegs">r_cleardrawsegs</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_plane">R_plane</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_plane.html#f_r_clearplanes">r_clearplanes</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_things">R_things</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_things.html#f_r_clearsprites">r_clearsprites</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_d_net">D_net</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/d_net.html#f_netupdate">netupdate</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_bsp">R_bsp</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_bsp.html#f_r_renderbspnode">r_renderbspnode</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_p_setup">P_setup</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/p_setup.html#f_nodes">nodes</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_count">count</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span><span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_d_net">D_net</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/d_net.html#f_netupdate">netupdate</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_plane">R_plane</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_plane.html#f_r_drawplanes">r_drawplanes</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_d_net">D_net</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/d_net.html#f_netupdate">netupdate</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_things">R_things</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_things.html#f_r_drawmasked">r_drawmasked</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_d_net">D_net</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/d_net.html#f_netupdate">netupdate</a>
		<span class="ekeyword">end</span>

	<a name="f_r_setupframe"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_setupframe">r_setupframe</a> <span class="esymbol">(</span><span class="elocal">player</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/player_t.html">PLAYER_T</a><span class="esymbol">)</span>
		<span class="ekeyword">local</span>
			<span class="elocal">i</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">do</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewplayer">viewplayer</a> <span class="esymbol">:=</span> <span class="elocal">player</span>
			<span class="ekeyword">check</span>
					<span class="ekeyword">attached</span> <span class="elocal">player</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/player_t.html#f_mo">mo</a> <span class="ekeyword">as</span> mo
			<span class="ekeyword">then</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewx">viewx</a> <span class="esymbol">:=</span> <span class="elocal">mo</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/degenmobj_t.html#f_x">x</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewy">viewy</a> <span class="esymbol">:=</span> <span class="elocal">mo</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/degenmobj_t.html#f_y">y</a>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangle">viewangle</a> <span class="esymbol">:=</span> <span class="elocal">mo</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/mobj_t.html#f_angle">angle</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_plus">+</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/angle_t.html">ANGLE_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/angle_t.html#f_from_natural">from_natural</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangleoffset">viewangleoffset</a><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_natural_32">to_natural_32</a><span class="esymbol">)</span>
			<span class="ekeyword">end</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_extralight">extralight</a> <span class="esymbol">:=</span> <span class="elocal">player</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/player_t.html#f_extralight">extralight</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewz">viewz</a> <span class="esymbol">:=</span> <span class="elocal">player</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/player_t.html#f_viewz">viewz</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewsin">viewsin</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><a class="efeature" href="../../brie_doom/tables.html#f_finesine">Finesine</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangle">viewangle</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/tables.html#f_angletofineshift">Angletofineshift</a><span class="edot">.</span><a class="efeature" href="../../base/natural_32_ref.html#f_as_integer_32">as_integer_32</a><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="esymbol">)</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewcos">viewcos</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_finecosine">Finecosine</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangle">viewangle</a> <a class="esymbol" href="../../base/natural_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <a class="efeature" href="../../brie_doom/tables.html#f_angletofineshift">Angletofineshift</a><span class="edot">.</span><a class="efeature" href="../../base/natural_32_ref.html#f_as_integer_32">as_integer_32</a><a class="esymbol" href="../../base/array.html#f_item">]</a>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_sscount">sscount</a> <span class="esymbol">:=</span> <span class="enumber">0</span>
			<span class="ekeyword">if</span> <span class="elocal">player</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/player_t.html#f_fixedcolormap">fixedcolormap</a> <span class="esymbol">/=</span> <span class="enumber">0</span> <span class="ekeyword">then</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_fixedcolormap">fixedcolormap</a> <span class="esymbol">:=</span> <span class="ekeyword">create</span><span class="esymbol"> </span><span class="esymbol">{</span><a class="eclass" href="../../brie_doom/pointers/index_in_array.html">INDEX_IN_ARRAY</a> <span class="esymbol">[</span><a class="eclass" href="../../brie_doom/render/lighttable_t.html">LIGHTTABLE_T</a><span class="esymbol">]</span><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/pointers/index_in_array.html#f_make">make</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">player</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/player_t.html#f_fixedcolormap">fixedcolormap</a><span class="esymbol">,</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_data">R_data</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_data.html#f_colormaps">colormaps</a><span class="esymbol">)</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_r_segs">R_segs</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/r_segs.html#f_walllights">walllights</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelightfixed">scalelightfixed</a>
				<span class="ekeyword">from</span>
					<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="enumber">0</span>
				<span class="ekeyword">until</span>
					<span class="elocal">i</span> <a class="esymbol" href="../../base/comparable.html#f_is_greater_equal">&gt;=</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightscale">Maxlightscale</a>
				<span class="ekeyword">loop</span>
					<span class="ekeyword">check</span>
							<span class="ekeyword">attached</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_fixedcolormap">fixedcolormap</a> <span class="ekeyword">as</span> fcm
					<span class="ekeyword">then</span>
						<a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelightfixed">scalelightfixed</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">i</span><a class="esymbol" href="../../base/array.html#f_item">]</a> <span class="esymbol">:=</span> <span class="elocal">fcm</span>
					<span class="ekeyword">end</span>
					<span class="elocal">i</span> <span class="esymbol">:=</span> <span class="elocal">i</span> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
				<span class="ekeyword">end</span>
			<span class="ekeyword">else</span>
				<a class="efeature" href="../../brie_doom/render/r_main.html#f_fixedcolormap">fixedcolormap</a> <span class="esymbol">:=</span> <span class="ekeyword">Void</span>
			<span class="ekeyword">end</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_framecount">framecount</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_framecount">framecount</a> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_validcount">validcount</a> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_validcount">validcount</a> <a class="esymbol" href="../../base/integer_32.html#f_plus">+</a> <span class="enumber">1</span>
		<span class="ekeyword">end</span>

	<a name="f_r_pointonside"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_pointonside">r_pointonside</a> <span class="esymbol">(</span><span class="elocal">x</span><span class="esymbol">,</span> <span class="elocal">y</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">;</span> <span class="elocal">node</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/render/node_t.html">NODE_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../../base/boolean.html">BOOLEAN</a>
			<span class="ecomment">--</span><span class="ecomment"> Traverse BSP (sub) tree,</span>
			<span class="ecomment">--</span><span class="ecomment"> check point against partition plane.</span>
			<span class="ecomment">--</span><span class="ecomment"> Returns side False (front) or True (back)</span>
		<span class="ekeyword">local</span>
			<span class="elocal">dx</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">dy</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">left</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
			<span class="elocal">right</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a>
		<span class="ekeyword">do</span>
			<span class="ekeyword">if</span> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dx">dx</a> <span class="esymbol">=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
				<span class="ekeyword">if</span> <span class="elocal">x</span> <a class="esymbol" href="../../base/comparable.html#f_is_less_equal">&lt;=</a> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_x">x</a> <span class="ekeyword">then</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dy">dy</a> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span>
				<span class="ekeyword">else</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dy">dy</a> <a class="esymbol" href="../../base/integer_32_ref.html#f_is_less">&lt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span>
				<span class="ekeyword">end</span>
			<span class="ekeyword">elseif</span> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dy">dy</a> <span class="esymbol">=</span> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span> <span class="ekeyword">then</span>
				<span class="ekeyword">if</span> <span class="elocal">y</span> <a class="esymbol" href="../../base/comparable.html#f_is_less_equal">&lt;=</a> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_y">y</a> <span class="ekeyword">then</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dx">dx</a> <a class="esymbol" href="../../base/integer_32_ref.html#f_is_less">&lt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span>
				<span class="ekeyword">else</span>
					<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dx">dx</a> <a class="esymbol" href="../../base/comparable.html#f_is_greater">&gt;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="enumber">0</span><span class="esymbol">)</span>
				<span class="ekeyword">end</span>
			<span class="ekeyword">else</span>
				<span class="elocal">dx</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="elocal">x</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_x">x</a><span class="esymbol">)</span>
				<span class="elocal">dy</span> <span class="esymbol">:=</span> <span class="esymbol">(</span><span class="elocal">y</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_minus">-</a> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_y">y</a><span class="esymbol">)</span>
				<span class="ekeyword">if</span> <span class="esymbol">(</span><span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dy">dy</a><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_bit_xor">bit_xor</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dx">dx</a><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_bit_xor">bit_xor</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">dx</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_bit_xor">bit_xor</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">dy</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_and">&#38;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../base/integer_32.html">INTEGER_32</a><span class="esymbol">}</span> <span class="enumber">-2147483648</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_boolean">to_boolean</a> <span class="ekeyword">then</span>
					<span class="ekeyword">if</span> <span class="esymbol">(</span><span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dy">dy</a><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_bit_xor">bit_xor</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">dx</span><span class="esymbol">)</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_and">&#38;</a> <span class="ekeyword">create</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/fixed_t.html#f_from_integer">from_integer</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="esymbol">(</span><span class="esymbol">{</span><a class="eclass" href="../../base/integer_32.html">INTEGER_32</a><span class="esymbol">}</span> <span class="enumber">-2147483648</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/integer_32_ref.html#f_to_boolean">to_boolean</a> <span class="ekeyword">then</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="ekeyword">True</span>
					<span class="ekeyword">else</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="ekeyword">False</span>
					<span class="ekeyword">end</span>
				<span class="ekeyword">else</span>
					<span class="elocal">left</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixedmul">fixedmul</a> <span class="esymbol">(</span><span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dy">dy</a> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracbits">fracbits</a><span class="esymbol">,</span> <span class="elocal">dx</span><span class="esymbol">)</span>
					<span class="elocal">right</span> <span class="esymbol">:=</span> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fixedmul">fixedmul</a> <span class="esymbol">(</span><span class="elocal">dy</span><span class="esymbol">,</span> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/divline_t.html#f_dx">dx</a> <a class="esymbol" href="../../base/integer_32_ref.html#f_bit_shift_right">|&gt;&gt;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/math/m_fixed.html">M_FIXED</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/math/m_fixed.html#f_fracbits">fracbits</a><span class="esymbol">)</span>
					<span class="ekeyword">if</span> <span class="elocal">right</span> <a class="esymbol" href="../../base/integer_32_ref.html#f_is_less">&lt;</a> <span class="elocal">left</span> <span class="ekeyword">then</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="ekeyword">False</span>
					<span class="ekeyword">else</span>
						<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <span class="ekeyword">True</span>
					<span class="ekeyword">end</span>
				<span class="ekeyword">end</span>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">feature</span> 

	<a name="f_r_pointinsubsector"></a><a class="efeature" href="../../brie_doom/render/r_main.html#f_r_pointinsubsector">r_pointinsubsector</a> <span class="esymbol">(</span><span class="elocal">x</span><span class="esymbol">,</span> <span class="elocal">y</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/math/fixed_t.html">FIXED_T</a><span class="esymbol">)</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/subsector_t.html">SUBSECTOR_T</a>
		<span class="ekeyword">local</span>
			<span class="elocal">node</span><span class="esymbol">:</span> <a class="eclass" href="../../brie_doom/render/node_t.html">NODE_T</a>
			<span class="elocal">side</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
			<span class="elocal">nodenum</span><span class="esymbol">:</span> <a class="eclass" href="../../base/integer_32.html">INTEGER_32</a>
		<span class="ekeyword">do</span>
			<span class="ekeyword">if</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_p_setup">P_setup</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/p_setup.html#f_numnodes">numnodes</a> <span class="esymbol">=</span> <span class="enumber">0</span> <span class="ekeyword">then</span>
				<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_p_setup">P_setup</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/p_setup.html#f_subsectors">subsectors</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_p_setup">P_setup</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/p_setup.html#f_subsectors">subsectors</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_lower">lower</a><a class="esymbol" href="../../base/array.html#f_item">]</a>
			<span class="ekeyword">else</span>
				<span class="elocal">nodenum</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_p_setup">P_setup</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/p_setup.html#f_numnodes">numnodes</a> <a class="esymbol" href="../../base/integer_32.html#f_minus">-</a> <span class="enumber">1</span>
				<span class="ekeyword">from</span>
				<span class="ekeyword">until</span>
					<span class="elocal">nodenum</span> <a class="esymbol" href="../../base/integer_32.html#f_bit_and">&#38;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/doomdata_h.html">DOOMDATA_H</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/doomdata_h.html#f_nf_subsector">nf_subsector</a> <span class="esymbol">/=</span> <span class="enumber">0</span>
				<span class="ekeyword">loop</span>
					<span class="elocal">node</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_p_setup">P_setup</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/p_setup.html#f_nodes">nodes</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">nodenum</span><a class="esymbol" href="../../base/array.html#f_item">]</a>
					<span class="elocal">side</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_r_pointonside">r_pointonside</a><span class="esymbol"> </span><span class="esymbol">(</span><span class="elocal">x</span><span class="esymbol">,</span> <span class="elocal">y</span><span class="esymbol">,</span> <span class="elocal">node</span><span class="esymbol">)</span><span class="edot">.</span><a class="efeature" href="../../base/boolean_ref.html#f_to_integer">to_integer</a>
					<span class="elocal">nodenum</span> <span class="esymbol">:=</span> <span class="elocal">node</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/render/node_t.html#f_children">children</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">side</span><a class="esymbol" href="../../base/array.html#f_item">]</a><span class="edot">.</span><a class="efeature" href="../../base/natural_16_ref.html#f_to_integer_32">to_integer_32</a>
				<span class="ekeyword">end</span>
				<span class="ekeyword">Result</span> <span class="esymbol">:=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_i_main">i_main</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/i_main.html#f_p_setup">P_setup</a><span class="edot">.</span><a class="efeature" href="../../brie_doom/p_setup.html#f_subsectors">subsectors</a> <a class="esymbol" href="../../base/array.html#f_item">[</a><span class="elocal">nodenum</span> <a class="esymbol" href="../../base/integer_32.html#f_bit_and">&#38;</a> <span class="esymbol">{</span><a class="eclass" href="../../brie_doom/doomdata_h.html">DOOMDATA_H</a><span class="esymbol">}</span><span class="edot">.</span><a class="efeature" href="../../brie_doom/doomdata_h.html#f_nf_subsector">nf_subsector</a><span class="edot">.</span><a class="efeature" href="../../base/integer_32.html#f_bit_not">bit_not</a><a class="esymbol" href="../../base/array.html#f_item">]</a>
			<span class="ekeyword">end</span>
		<span class="ekeyword">end</span>
	
<span class="ekeyword">invariant</span>
		<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_lower">lower</a> <span class="esymbol">=</span> <span class="enumber">0</span>
		<a class="efeature" href="../../brie_doom/render/r_main.html#f_viewangletox">viewangletox</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_count">count</a> <span class="esymbol">=</span> <a class="efeature" href="../../brie_doom/tables.html#f_fineangles">Fineangles</a> <a class="esymbol" href="../../base/integer_32.html#f_integer_quotient">//</a> <span class="enumber">2</span>
		<a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelightfixed">scalelightfixed</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_lower">lower</a> <span class="esymbol">=</span> <span class="enumber">0</span> <a class="ekeyword" href="../../base/boolean.html#f_conjuncted">and</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelightfixed">scalelightfixed</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_count">count</a> <span class="esymbol">=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightscale">Maxlightscale</a>
		<a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelight">scalelight</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_lower">lower</a> <span class="esymbol">=</span> <span class="enumber">0</span> <a class="ekeyword" href="../../base/boolean.html#f_conjuncted">and</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelight">scalelight</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_count">count</a> <span class="esymbol">=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a> <a class="ekeyword" href="../../base/boolean.html#f_conjuncted">and</a> <span class="ekeyword">across</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_scalelight">scalelight</a> <span class="ekeyword">as</span> sc_level
		<span class="ekeyword">all</span>
			<span class="elocal">sc_level</span><span class="edot">.</span><a class="efeature" href="../../base/general_special_iteration_cursor.html#f_item">item</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_lower">lower</a> <span class="esymbol">=</span> <span class="enumber">0</span> <a class="ekeyword" href="../../base/boolean.html#f_conjuncted">and</a> <span class="elocal">sc_level</span><span class="edot">.</span><a class="efeature" href="../../base/general_special_iteration_cursor.html#f_item">item</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_count">count</a> <span class="esymbol">=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightscale">Maxlightscale</a>
		<span class="ekeyword">end</span>
		<a class="efeature" href="../../brie_doom/render/r_main.html#f_zlight">zlight</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_lower">lower</a> <span class="esymbol">=</span> <span class="enumber">0</span> <a class="ekeyword" href="../../base/boolean.html#f_conjuncted">and</a> <a class="efeature" href="../../brie_doom/render/r_main.html#f_zlight">zlight</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_count">count</a> <span class="esymbol">=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_lightlevels">Lightlevels</a> <a class="ekeyword" href="../../base/boolean.html#f_conjuncted">and</a> <span class="ekeyword">across</span>
			<a class="efeature" href="../../brie_doom/render/r_main.html#f_zlight">zlight</a> <span class="ekeyword">as</span> zl_level
		<span class="ekeyword">all</span>
			<span class="elocal">zl_level</span><span class="edot">.</span><a class="efeature" href="../../base/general_special_iteration_cursor.html#f_item">item</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_lower">lower</a> <span class="esymbol">=</span> <span class="enumber">0</span> <a class="ekeyword" href="../../base/boolean.html#f_conjuncted">and</a> <span class="elocal">zl_level</span><span class="edot">.</span><a class="efeature" href="../../base/general_special_iteration_cursor.html#f_item">item</a><span class="edot">.</span><a class="efeature" href="../../base/array.html#f_count">count</a> <span class="esymbol">=</span> <a class="efeature" href="../../brie_doom/render/r_main.html#f_maxlightz">Maxlightz</a>
		<span class="ekeyword">end</span>

<span class="ekeyword">end</span> <span class="ecomment">--</span> <span class="ecomment">class </span><a class="eclass" href="../../brie_doom/render/r_main.html">R_MAIN</a></pre><form class="nav" onsubmit="go_to('../../',this.c.value);return false;">
<div class="nav">
<a class="nav hierarchy" href="../../class_list.html">Classes</a>
<a class="nav hierarchy" href="../../cluster_list.html">Clusters</a>
<a class="nav hierarchy" href="../../cluster_hierarchy.html">Cluster hierarchy</a>
<a class="nav class" href="r_main_chart.html">Chart</a>
<a class="nav class" href="r_main_links.html">Relations</a>
<span class="nav class selected">Text</span>
<span class="nav class goto">Go to: <input name="c" value="r_main"></span>
</div></form><pre></pre>
<p style="text-align:center;">Generated by <a href="http://www.eiffel.com">ISE EiffelStudio</a></p>
</body>
</html>

